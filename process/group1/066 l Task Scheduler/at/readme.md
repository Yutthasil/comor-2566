# at
ส่วนใหญ่แล้วผู้คนมักจะใช้ **cron** เป็นหลักมากกว่าใช้  **at** เพราะอย่างที่บอกไปตอนต้นว่า cron นั้นทำเป็นประจำ แต่ at <ins>ทำงานเพียงครั้งเดียว</ins> และมีความง่ายมากกว่า โดยการจะเรื่มใช้งานนั้น เราจะต้อง install at software package และ atd service กำลังทำงาน

ใน Ubuntu เราใช้คำสั่งดังต่อไปนี้ในการติดตั้ง at package
``` 
$ Sudo apt install  -y at 
```
สามารถเช็คว่ามีการติดตั้งหรือยังด้วยการ
``` 
$ rpm - q at
```
>ถ้าไม่มี จะมี error แจ้งเตือนมาว่า ยังไม่มีการติดตั้ง at package

และ เช็คว่า atd service ทำงานอยู่หรือมั้ย ด้วยการ 
``` 
$ service atd status 
```
>ถ้าไม่ทำงาน ก็จะแจ้งเตือนว่า atd หยุดทำงาน แก้ปัญหาให้ atd ทำงานโดยการใช้คำสั่ง
> ``` $ service atd start ``` ให้ทำงาน และสามารถตั้งค่าเริ่มต้นให้ atd service เริ่มต้นทำงานทุกคนั้งที่เปิดระบบ ด้วย  ``` $ chkconfig atd on ```

## at command
```
$ at <time>
>at <job>
```
- time คือ เวลา หรือวัน DD.MM.YY เช่น 23:02 ก็จะเป็น ``` $ at 23:02 ``` 
- task คือ งานที่ต้องการให้ทำ

ถ้าอยากรัน file ใน bash หรือ txt หรือ ไฟล์อื่นๆ ก็จะเป็น
```
$ at <time> -f <file name>
```

ตัวอย่างเช่น ต้องการให้ run หลังจาก 1 ชมต่อจากนี้
```
$ at now + 1 hour
```

```
$ at 8am + 2 day -f job.sh
```
เมื่อถึงเวลาที่ตั้งไว้ task นั้นก็จะทำงาน และ เมื่อคุณต้องการจะบอก ระบบว่า<ins>ทำงานเสร็จแล้ว ให้กด Ctrl + D</ins> แต่ถ้าอยาก<ins>ยกเลิก at job ให้ใช้ Ctrl + C </ins>โดย file at job ถูกเก็บอยู่ใน ```/var/spool/at```

นอกจากนี้ยังมีคำสั่งขั้นสูงเพิ่มเติมได้แก่
- ```-f``` : เจาะจงไฟล์ที่ต้องการจะใส่คำสั่ง  at
	- ```at -f commands.txt 10:30 PM```
- ```-l``` : แสดงงานทั้งหมด ทั้งอยู่ในคิว และ เสร็ตแล้ว
	- ```at -l```
- ```-d``` : ลบงาน โดยไม่สนว่างานนั้นจะอยู่สถานะไหน
	- ```at -d 1```
- ```-c``` : โชว์เนื้อหาข้างใน
	- ```at -c 1```
- ```-c``` : ให้ทำงานอยู่เบื้องหลัง
	- ```at -b now + 1 minute < commands.txt```
- ```-m``` : ส่ง mail ให้ user เมื่อทำงานเสร็จสิ้น 
	- ```at -m now + 1 minute < commands.txt```
- ```-q``` : ระบุคิว ( a คือ คิว)
	- ```at -q a now + 1 minute < commands.txt```
- ```-v``` : แสดงข้อมูลของ task ที่กำลังทำ
	- ```at -v now + 1 minute < commands.txt```


## atq
ใช้แสดง<ins> listคิว ของ job </ins>ที่ถูกตั้งเวลาไว้แล้ว (ยังไม่เสร็จ จึงไม่เหมือนกับ at-l)
```
$ atq
```
โดย output ของมันก็แสดงดังรูปข้างล่างของแต่ละ job ที่อยู่ใน list
```
<Number> <Date> <Hour> <Queue> <User>
```
- Number : หมายเลขงาน
- Date : วันที่ job โดน execute
- Hour : เวลาที่ job โดน execute
- Queue : ชื่อ Queue เป็น a-z โดย a เป็นค่าตั้งต้น
- User : ชื่อ user ที่เป็นคนตั้งค่าเวลา


## atrm
ใช้คำสั่งนี้ในการ <ins>ลบ jobที่อยู่ในคิว(ยังไม่เริ่มทำงาน)</ins> โดย
```
$ atrm <number>
```
- number ที่ว่า ก็คือ หมายเลขงาน สามารถดูได้จาก **atq**
> แต่จะลบได้นั้น เราต้องเป็น<ins>เจ้าของ</ins>นะ!


# batch
ทำงานเหมือน at ตรงที่กำหนดเวลาไว้ ครั้งเดียว แต่ต่างกันตรงที่ว่า batch จะทำเฉพาะตอนที่ system’s load average ต่ำกว่า 0.8 ซึ่งค่านี้ก็สามารถแก้ไข default ได้ ด้วยการใช้ ```atd - l```
