# Host Configuration

Host บน Linux มีบทบาทและหน้าที่หลากหลายที่สำคัญต่อการทำงานของระบบปฏิบัติการและการเชื่อมต่อในเครือข่าย ดังนี้:

- ชื่อโฮสต์ (Hostname):
ชื่อโฮสต์เป็นตัวแทนของเครื่องในเครือข่าย มันช่วยให้คนหรือระบบอื่น ๆ สามารถระบุและเชื่อมต่อกับเครื่องของเราได้
การตั้งค่าชื่อโฮสต์ใน Linux เป็นส่วนหนึ่งของการกำหนดค่าระบบ และสามารถทำผ่านคำสั่ง hostname หรือการแก้ไขไฟล์ /etc/hostname และ /etc/hosts

- การกำหนดค่าเครือข่าย (Network Configuration):
Host ต้องมีการกำหนดค่าเครือข่ายให้เหมาะสม เพื่อให้สามารถเชื่อมต่อกับเครือข่ายได้ถูกต้อง
การตั้งค่า IP address, netmask, gateway, DNS server และการกำหนดค่าอื่น ๆ สามารถทำผ่านไฟล์ /etc/network/interfaces หรือไฟล์ที่เกี่ยวข้องกับเครือข่าย

- การกำหนดค่าความปลอดภัย (Security Configuration):
Host ต้องมีการกำหนดค่าความปลอดภัยเพื่อป้องกันการเข้าถึงไม่จำเป็นและการโจมตี.
การใช้ไฟร์วอลล์ (firewall) เพื่อควบคุมการเข้าถึง, การปิดใช้งานบริการที่ไม่จำเป็น, การตั้งค่าการให้สิทธิ์ผู้ใช้ และการดูแลรักษาความปลอดภัยทั่วไป

- การกำหนดค่าผู้ใช้ (User Configuration):
Host ต้องมีการจัดการผู้ใช้งานที่เข้าถึงระบบ
การสร้าง, แก้ไข, และลบผู้ใช้งาน, การกำหนดรหัสผ่าน, และการจัดการสิทธิ์ผู้ใช้โดยใช้ไฟล์ /etc/passwd, /etc/shadow, และ /etc/group

- การกำหนดค่าเวลา (Time Configuration):
Host ต้องมีการกำหนดค่าเวลาให้ถูกต้อง เพื่อป้องกันปัญหาการทำงานและการเชื่อมต่อในเครือข่าย
การใช้คำสั่ง timedatectl เพื่อตั้งค่าเวลาและโซนเวลา, การใช้ NTP (Network Time Protocol) เพื่อซิงโครไนส์เวลากับเซิร์ฟเวอร์ NTP

- การจัดการแพ็กเกจ (Package Management):
Host ต้องมีการจัดการแพ็กเกจที่ติดตั้งบนระบบ เพื่อให้ระบบปฏิบัติการมีความเสถียรและปลอดภัย
การใช้ package manager เช่น apt, yum, หรือ zypper เพื่อติดตั้ง, อัปเดต, และลบแพ็กเกจ
การจัดการ Host บน Linux เป็นส่วนสำคัญของการบริหารระบบและรักษาความปลอดภัยของระบบทั้งหมดในเครือข่าย



## หลักการทำงานของ Host Configuration 

Host Configuration file จะให้บริการการตั้งค่าและจัดการการแปลงชื่อ host เป็น IP ท้องถิ่น และการแทนที่การแก้ไข DNS บนระบบ Linux  โดย path คือ /etc/hosts และไฟล์ข้อความธรรมดาที่แมปชื่อ host กับที่อยู่ IP ที่เป็นไฟล์ระบบและต้องใช้สิทธ์ root หรือสิทธิ์ผู้ดูแลระบบเพื่อทำการปรับเปลี่ยน 

ไฟล์ช่วยให้เรากำหนดค่าแมปชื่อโฮสต์เป็นไอพีที่กำหนดเองสำหรับระบบท้องถิ่นของเราแต่ละบรรทัดในไฟล์ hosts จะปฏิบัติตามรูปแบบที่เฉพาะเจาะจง ประกอบด้วยที่อยู่ไอพีที่ตามด้วยชื่อโฮสต์หนึ่งหรือมากกว่าที่แยกด้วยช่องว่าง ที่อยู่ไอพีมักจะตามด้วยชื่อโฮสต์ที่เกี่ยวข้อง 

ไฟล์ hosts ยังสามารถจัดการที่อยู่ไอพีเวอร์ชัน 6 และที่อยู่ไอพีเวอร์ชัน 4 ได้เช่นกัน


## Configure Hostname
Configure a static hostname:
คือการเปลี่ยนชื่อ hostname ของเครื่องเราโดยที่ถ้าเรา reboot ใหม่ ชื่อจะคืนค่ากลับมาเป็นเหมือนเดิม
โดยการระบุของ hostname ของเราจะสามารถใช้คำสั่งได้ดังนี้ :

```
$ hostname
```

และในการ Configure hostname แบบ static จะสามารถใช้คำสั่งได้ดังนี้ :
โดยจะลองเปลี่ยนเป็น test.example.com

```
$ hostname test.example.com
```
ผลลัพธ์มีดังนี้ :
 
![hostname](https://github.com/CosmoGuy112/PHost/assets/112687431/74739192-08f6-4fc6-932c-c96b6bb56e95)


Configure a persistent hostname
คือ การเปลี่ยนชื่อ hostname ของเครื่องเราโดยใน Config ส่วนนี้จะทำการเปลี่ยนค่า default เลย โดยจะเข้าไป config ใน /etc/hostname
โดยคำสั่งในการเปลี่ยนค่า hostname ในส่วนนี้คือ :

```
$ hostnamectl set-hostname test2.example.com
```

โดยจะสามารถเช็คค่า hostname ที่เปลี่ยนไปได้ใน

```
cat /etc/hostname
```

ผลลัพธ์มีดังนี้ :

![Screenshot 2024-02-07 002738](https://github.com/CosmoGuy112/PHost/assets/112687431/9ea4116a-1e0f-443b-bac8-7e5b2284223d)


## Configure Time & Date
ในการตั้งค่า Config วันเละเวลา คำสั่งที่ควรจะรู้คือ :

```
$ timedatectl
```
โดยคำสั่งนี้คือคำสั่งที่จะดูข้อมูลและเวลาปัจจุบันและค่าอื่นๆ

ซึ่งเมื่อพิมพ์คำสั่งจะได้ผลลัพธ์ดังนี้ :

![Screenshot_2024-02-07_003002](https://github.com/CosmoGuy112/PHost/assets/112687431/73464afa-0413-4866-b2c1-32b31566a2a9)

โดย Output ที่แสดงออกมาสามารถบอกได้ดังนี้
- เวลาท้องถิ่น: เวลาที่คอมพิวเตอร์คิดว่าเป็นเวลาตามโซนเวลา (จากรูปเครื่องนี้ local เป็น UTC)
- เวลาสากล: เวลา UTC
- เวลา RTC: เวลาที่ใช้นาฬิกาเรียลไทม์ โดยปกติจะเป็น UTC
- โซนเวลา: ข้อมูลเกี่ยวกับโซนเวลาที่กำหนดค่า
- ซิงโครไนซ์นาฬิการะบบ: ซิงโครไนซ์นาฬิการะบบกับเซิร์ฟเวอร์ NTP หรือไม่
- บริการ NTP: บริการ NTP ของคอมพิวเตอร์ทำงานอยู่หรือไม่
- RTC ใน TZ ท้องถิ่น: ระบุว่านาฬิกาตามเวลาจริงใช้เวลาท้องถิ่นแทน UTC หรือไม่

```
$ timedatectl set-timezone "Asia/Bangkok"
```
โดยคำสั่งนี้คือคำสั่งที่ set timezone ของประเทศไทย

ซึ่งเมื่อพิมพ์คำสั่งจะได้ผลลัพธ์ดังนี้ :

![Screenshot_2024-02-07_003002](https://github.com/CosmoGuy112/PHost/assets/112687431/8338271a-0fc4-4684-9952-396dd91ff917)


```
$ timedatectl set-time "2024-02-02 10:30:00"
```
โดยคำสั่งนี้คือคำสั่งที่สามารถ set เวลาและวันที่ ได้โดยตรงเลยซึ่งต่างกับคำสั่งก่อนหน้าคือเป็นเวลาปัจจุบันของแต่ละ timezone ที่เราจะไปเปลี่ยนแปลง
โดยคำสั่งนี้จะ เรียงตาม "YYYY-MM-DD HH-MM-SS"

ซึ่งเมื่อพิมคำสั่งจะได้ผลลัพธ์ดังนี้ :


![Screenshot 2024-02-07 013217](https://github.com/CosmoGuy112/PHost/assets/112687431/ed62f5c1-8883-467e-bd93-219993c666cf)

โดยก่อนใช้คำสั่ง set-time ได้จะต้องตั้งค่าจะต้องใช้คำสั่ง :

```
sudo systemctl stop systemd-timesyncd.service
```
เพื่อปิดการ Synchronize ของเวลาก็คือให้สามารถ set-time ด้วยตัวเองได้

ส่วนในการเปิด Synchronize ของเวลาจะใช้คำสั่ง :

```
sudo systemctl start systemd-timesyncd.service
```
ซึ่งจะทำให้เวลาคืนค่ามายัง timezone เดิม

## lshw
เป็นเครื่องมือขนาดเล็กสำหรับดึงข้อมูลโดยละเอียดเกี่ยวกับการกำหนดค่าฮาร์ดแวร์ของเครื่อง สามารถรายงานการกำหนดค่าหน่วยความจำ เวอร์ชันเฟิร์มแวร์ การกำหนดค่าเมนบอร์ด เวอร์ชัน CPU และความเร็ว การกำหนดค่าแคช ความเร็วบัส ฯลฯ ที่แน่นอนบนระบบ x86 หรือ IA-64 ที่รองรับ DMI และในเครื่อง PowerPC บางเครื่อง
โดยคำสั่งที่ควรรู้ในการ Config ต่างใน Tool lshw มีดังนี้ :

- สามารถดูรายละเอียดเกี่ยวกับ hardware ของเครื่องได้ทั้งหมด

```
$ lshw 
```
- สามารถดูรายละเอียดแบบย่อๆได้โดยใช้คำสั่ง :

```
$ lshw -short
```
ผลลัพธ์จะได้ดังนี้

![Screenshot 2024-02-07 202649](https://github.com/CosmoGuy112/PHost/assets/112687431/8b91324c-93b2-42a2-9d3d-94e84fc2959a)

โดยการแสดงข้อมูลทั้งหมดของ Tool lshw นั้นจะไม่ได้แสดงทั้งหมดซึ่งบางอันอาจจะต้องใช้คำสั่ง : -enable

```
$ lshw -enable <TEST>
```

โดยใน TEST สามารถกำหนดเองได้ว่าต้องการให้แสดงข้อมูลของอะไร เช่น
pci, isapnp, cpuid, usb, network, dmi, device-tree, cpuinfo
มีตัวอย่างดังนี้

![ooure58](https://github.com/CosmoGuy112/PHost/assets/112687431/8bd5b006-1fc1-4def-9aac-e729c547de2a)

> img ref : https://www.geeksforgeeks.org/lshw-command-in-linux-with-examples/


โดยเมื่อมี -enable แล้วก็จะมีคำสั่ง : -disable 

```
$ lshw -disable <TEST>
```
ซึ่งจะคอยปิดการแสดงข้อมูลของสิ่งที่เรากำหนดไปข้างต้น

```
$ lshw -class <CLASS>
```
เป็นคำสั่งที่สามารถเปิดดูข้อมูลของแต่ละคลาสที่กำหนด มีตัวอย่างดังนี้ :

![disk](https://github.com/CosmoGuy112/PHost/assets/112687431/2fb5c4b8-df25-428d-b2e1-00cead6fb36c)

```
$ lshw -quiet
```
เป็นคำสั่งที่จะปิดสถานะต่างๆของข้อมูล เช่น การค้นหาอุปกรณ์ การเปิดการเชื่อมต่อ ฯลฯ จะเห็นแค่ข้อมูลของ hardware 

```
$ lshw -sanitize
```
เป็นคำสั่งที่ต้องการที่จะลบข้อมูล ที่ sensitive เช่น serial number

## lscpu
lscpu จะแสดงข้อมูลเกี่ยวกับสถาปัตยกรรมของ CPU lscpu รวบรวมข้อมูลสถาปัตยกรรมซีพียูจาก sysfs และ / proc / cpuinfo เอาท์พุทคำสั่งสามารถเพิ่มประสิทธิภาพสำหรับการแยกวิเคราะห์หรือเพื่อให้สามารถอ่านได้ง่ายโดยมนุษย์ ข้อมูลประกอบด้วยตัวอย่างเช่นจำนวนซีพียูเธรดคอร์ซ็อกเก็ตและโหนดการเข้าถึงหน่วยความจำที่ไม่ใช่ (NUMA) นอกจากนี้ยังมีข้อมูลเกี่ยวกับแคชของ CPU และการใช้งานร่วมกันของแคชครอบครัวแบบปลอมแปลง MIPS คำสั่งไบต์และการก้าว
โดยมีคำสั่งที่ควรจะรู้ ใน lscpu Tool :

```
$ lscpu
```

![Screenshot 2024-02-08 172614](https://github.com/CosmoGuy112/PHost/assets/112687431/3a96cef6-872d-4d4d-90fa-c9eff68b7239)

<br>
คำสั่งย่อยๆ ใน lscpu Tool :
<br>

| Command                             |   Descript                              |
| ----------------------------------- | --------------------------------------- |
| `lscpu -e` | จะแสดงข้อมูลเกี่ยวกับ CPU ของคุณในรูปแบบตารางที่อ่านง่าย  โดยแสดงข้อมูลสำคัญต่างๆ เช่น ชื่อผู้ผลิต, โมเดล, ความเร็ว, จำนวนคอร์ |
| `lscpu -p` | จะช่วยปรับแต่งผลลัพธ์ของคำสั่งให้แยกวิเคราะห์ได้ง่ายมากขึ้น |
| `lscpu -c` | จะแสดงผลลัพธ์เฉพาะ CPU ที่ออฟไลน์ คำสั่งนี้ใช้ได้เฉพาะกับargument -e หรือ -p|
| `lscpu -b` | จะแสดงผลลัพธ์เฉพาะ CPU ที่เปิดใช้งานอยู่ (เป็นค่าเริ่มต้นสำหรับ -p) คำสั่งนี้ใช้ได้เฉพาะกับargument -e หรือ -p|
| `lscpu -a` | จะแสดงผลลัพธ์ทั้ง CPU ที่ออนไลน์ และออฟไลน์ ทั้งหมด |
| `lscpu -x` | คุณระบุชุด CPU ที่ต้องการแสดงข้อมูลในคำสั่ง โดยใช้ เลขฐานสิบหกแทนหมายเลขประจำตัว CPU (ต้องมีความชำนาญเกี่ยวกับเลขฐาน16 เพราะว่าถ้าใส่ผิดผลลัพธ์อาจจะผิดหรือไม่แสดงออกมา) |
| `lscpu -c` | จะแสดงผลข้อมูล detail ต่างๆของ caches|
| `lscpu -s` | เป็นคำสั่งที่ช่วยให้สามารถระบุ path ไปยัง Directory root ของอินสแตนซ์ Linux อื่นเพื่อรวบรวมข้อมูล CPU ได้| 


<br>

# สิ่งที่น่าสนใจ
> Host Security 
- ตรวจสอบให้แน่ใจว่า SELinux(Security Enhance Linux) ถูกกำกนดค่าอย่างถูกต้องสำหรับการติดตั้ง และทำงานในโหมด enforcing

- ลบหรือปิดใช้บริการที่ไม่จำเป็น เช่น AutoFS, NFS, FTP, HTTP, NIS, telnetd หรือ sendmail 

- เพิ่มเฉพาะจำนวนบัญชีผู้ใช้ที่จำเป็นสำหรับการจัดการแพลตฟอร์มบนเซิร์ฟเวอร์และลบบัญชีผู้ใช้ที่ไม่จำเป็น จำกัดการเข้าถึงโดยตรงที่ระบบไปยังผู้ใช้เพียงคนเดียวที่มีความจำเป็นในการจัดการระบบ 

- หลีกเลี่ยงการใช้งานแอปพลิเคชันที่ไม่จำเป็นบนโฮสต์ การรันแอปพลิเคชันบนโฮสต์อาจมีผลต่อประสิทธิภาพของเครื่องเสมือนและสามารถส่งผลต่อความเสถียรของเซิร์ฟเวอร์ได้ 

- ใช้ตำแหน่งที่เป็นศูนย์สำหรับการติดตั้งและภาพเครื่องเสมือน ภาพเครื่องเสมือนควรถูกเก็บไว้ที่ /var/lib/libvirt/images/ 

- รันเฉพาะบริการที่จำเป็นสำหรับการใช้งานและการจัดการระบบ หากต้องการบริการเพิ่มเติม เช่น การให้บริการไฟล์หรือการพิมพ์ ต้องรันบน Red Hat Enterprise Linux 

- ให้แน่ใจว่าการตรวจสอบได้เปิดใช้งานบนระบบโฮสต์และ libvirt ได้รับการกำหนดค่าเพื่อสร้างบันทึกการตรวจสอบ 

- แน่ใจว่าการบริหารจัดการระบบทางไกลทำได้เฉพาะผ่านช่องทางเครือข่ายที่ปลอดภัย เช่น SSH และโปรโตคอลเครือข่ายเช่น TLS หรือ SSL 

- การเชื่อมต่ออุปกรณ์ USB, Physical Function หรืออุปกรณ์ทางกายภาพเมื่อ SR-IOV ไม่สามารถใช้งานกับเครื่องเสมือนได้ อาจทำให้มีการเข้าถึงอุปกรณ์ที่มีความพอดีที่จะเขียนทับซอฟต์แวร์ของอุปกรณ์นั้น 

- แน่ใจว่าไฟวอลล์ได้รับการกำหนดค่าอย่างถูกต้องสำหรับการติดตั้งของคุณและเปิดใช้งานในขณะที่บูตเครื่อง เฉพาะพอร์ตเครือข่ายที่จำเป็นสำหรับการใช้งานและการจัดการระบบเท่านั้นควรได้รับอนุญาต 




# References
<li>https://tldp.org/HOWTO/Xterminals/configuration.html</li>
<li>https://www.redhat.com/sysadmin/configure-hostname-linux</li>
<li>https://devconnected.com/how-to-set-date-and-time-on-linux/</li>
<li>https://www.scaler.com/topics/ntp-in-linux/</li>
<li>https://support.huawei.com/enterprise/en/doc/EDOC1100318951/aad02e92/linux-host-security-protection</li>
<li>https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/virtualization_security_guide/chap-virtualization_security_guide-host_security</li>
<li>https://th.linux-console.net/?p=8474</li>
<li> https://www.geeksforgeeks.org/lshw-command-in-linux-with-examples/ </li>
<li>https://phoenixnap.com/kb/lscpu</li>

